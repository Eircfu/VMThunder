#!/usr/bin/env python

import sys
#sys.path.append("..")

from vmthunder.getconf import GetConf
#TODO change GetConf to oslo.config
from vmthunder import compute
from vmthunder.common import wsgi
from vmthunder.openstack.common import log as logging

def start():
    gc = GetConf('../etc/vmthunder/vmthunder.conf')
    fcg_name = gc.get_fcg_name()
    ssds = gc.get_fcg_ssds()
    block_size = gc.get_fcg_blocksize()
    pattern = gc.get_fcg_pattern()

    cn = compute.get_compute(fcg_name, ssds, block_size, pattern)

    server = wsgi.Server('vmthunder-api', '/root/VMThunder/bin/api-paste.ini')
    server.start()
    server.wait()


if __name__ == '__main__':
    #logging.setup('vmthunder')
    start()
